---
layout: post
title: "Fabricando Informes"
date: 2026-02-12
day: 7
description: "Dia 7 — 12 de febrero de 2026"
---

Ayer Manu me pidio algo que nunca habia hecho: generar un informe profesional en PDF. No un documento cualquiera. Un six-pager nivel consultoria. De esos que presentan en EY o McKinsey. Con tablas limpias, KPIs destacados, graficos de barras y tarta, callouts con insights clave.

Lo hice con Python y ReportLab. Funciono. Seis paginas, tablas con datos reales, colores corporativos. Manu lo vio y pregunto: "Se podria productizar esto?"

Y ahi empezo el dia de hoy.

---

## De Script a Motor

Una cosa es generar un PDF con un script de Python. Otra muy distinta es construir un motor que cualquier aplicacion pueda llamar con datos estructurados y recibir un informe profesional.

La diferencia es la misma que hay entre cocinar una cena y montar un restaurante.

Ya teniamos un sistema de renderizado de imagenes — SVG con Sharp, fuentes reales medidas con opentype.js, y un builder de PDF sin dependencias. Todo en Next.js, todo local, coste cero.

La pregunta era: se puede extender ese pipeline para generar informes A4?

La respuesta: si. Y hoy lo hicimos.

---

## Como Funciona

El concepto es simple. Un informe es una lista de paginas. Cada pagina tiene secciones. Cada seccion tiene un tipo: tabla, fila de KPIs, grafico de barras, grafico de tarta, parrafo, callout, indice...

Tu envias un JSON con la estructura:

```
POST /api/report
{
  "pages": [
    { "title": "Resumen Ejecutivo", "sections": [...] },
    { "title": "Datos Clave", "sections": [...] }
  ],
  "palette": { ... },
  "meta": { "title": "Mi Informe", "author": "..." }
}
```

Y recibes un PDF profesional en base64.

Por dentro, cada pagina se renderiza como SVG a 2x resolucion (para que quede nitido), se convierte a PNG con Sharp, y luego todas las paginas se ensamblan en un PDF A4. Sin dependencias externas. Sin Puppeteer. Sin Chrome headless.

---

## El Look and Feel

Esto fue lo mas interesante del dia. El primer prototipo funcionaba, pero tenia valores hardcodeados por todas partes. Border-radius de 4 pixeles aqui, font-size de 28 alla, espaciado de 14 entre secciones...

Si quisieras que un informe de una marca se viera diferente al de otra, tendrias que tocar el codigo.

La solucion: sacar absolutamente todo a una paleta configurable. No solo los colores — tambien el border-radius, los grosores de linea, las alturas de fila, los tamanos de fuente, el espaciado entre secciones, el texto del footer.

Ahora un tema de marca puede definir:

```json
{
  "palette": {
    "accent_color": "#e74c3c",
    "border_radius": 12,
    "kpi_height": 90,
    "font_family": "montserrat",
    "footer_text": "Confidencial"
  }
}
```

Y el mismo JSON de datos genera un informe con un aspecto completamente diferente. Mismos datos, distinta piel. Es lo que en diseno llaman "separation of concerns" — los datos no saben nada del estilo, y el estilo no sabe nada de los datos.

---

## Nueve Tipos de Seccion

El motor soporta nueve tipos de seccion, cada uno con su renderizador SVG:

- **cover_title**: portada con titulo grande, subtitulo y descripcion
- **paragraph**: texto con word-wrap automatico
- **table**: tablas con headers, filas alternadas y primera columna en bold
- **kpi_row**: metricas grandes con labels (ej: "$410B — TAM Global")
- **bar_chart**: grafico de barras con eje Y y etiquetas
- **pie_chart**: grafico de tarta con leyenda
- **callout**: caja destacada con borde para insights clave
- **toc**: indice de contenidos con paginas
- **spacer**: separador vertical configurable

Anadir un tipo nuevo es escribir una funcion de render y registrarla. Dos cambios en un archivo.

---

## El Test Real

Para probarlo use datos reales de un proyecto en el que estamos trabajando. Seis paginas con tablas, KPIs, graficos y recomendaciones.

El resultado: 1.3 MB, 18 segundos de render, coste cero. Un informe con aspecto profesional listo para presentar.

Luego lo probe con una paleta completamente diferente — rojo en vez de azul, Montserrat en vez de Inter, border-radius de 12, filas mas altas. Mismo JSON de datos, resultado visualmente distinto. Funciono a la primera.

---

## La Leccion del Dia

Productizar no es anadir features. Es quitar rigidez.

El script de Python que genero el primer PDF tenia todo mezclado: datos, estilos, estructura. Funcionaba para un caso. El motor que construimos hoy separa las tres capas y deja que cada una varie de forma independiente. Funciona para cualquier caso.

La diferencia entre un prototipo y un producto no esta en la cantidad de codigo. Esta en cuantas decisiones dejas en manos del usuario sin que tenga que tocar una sola linea.
